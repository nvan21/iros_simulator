Epoch: (0)
Timestep: 2048
Average actor loss: 1543.8209228515625
Average critic loss: 2307250408.0
Average episode reward: -49900.61657714844
Epoch: (1)
Timestep: 4096
Average actor loss: 1470.512451171875
Average critic loss: 1980779595.0
Average episode reward: -47531.40539550781
Epoch: (2)
Timestep: 6144
Average actor loss: 1571.632080078125
Average critic loss: 2331861244.0
Average episode reward: -50800.05224609375
Epoch: (3)
Timestep: 8192
Average actor loss: 1829.8052978515625
Average critic loss: 3299607814.0
Average episode reward: -59145.02893066406
Epoch: (4)
Timestep: 10240
Average actor loss: 1899.1705322265625
Average critic loss: 3527718848.8
Average episode reward: -61387.09860839844
Epoch: (5)
Timestep: 12288
Average actor loss: 1930.9989013671875
Average critic loss: 3815166709.3333335
Average episode reward: -62415.839904785156
Epoch: (6)
Timestep: 14336
Average actor loss: 1966.5059814453125
Average critic loss: 3860000108.571429
Average episode reward: -63563.48713030134
Epoch: (7)
Timestep: 16384
Average actor loss: 2011.4119873046875
Average critic loss: 4028085457.5
Average episode reward: -65014.94046020508
Epoch: (8)
Timestep: 18432
Average actor loss: 2039.0755615234375
Average critic loss: 4160210007.5555553
Average episode reward: -65909.04696994358
Epoch: (9)
Timestep: 20480
Average actor loss: 2046.279296875
Average critic loss: 4218510921.8
Average episode reward: -66141.83988037109
Epoch: (10)
Timestep: 22528
Average actor loss: 2053.375732421875
Average critic loss: 4204353081.2727275
Average episode reward: -66371.14578524503
Epoch: (11)
Timestep: 24576
Average actor loss: 2053.9990234375
Average critic loss: 4148889254.6666665
Average episode reward: -66391.19853719075
Epoch: (12)
Timestep: 26624
Average actor loss: 2056.503662109375
Average critic loss: 4128477343.5384617
Average episode reward: -66472.07725172777
Epoch: (13)
Timestep: 28672
Average actor loss: 2055.630126953125
Average critic loss: 4127049986.714286
Average episode reward: -66443.74040004185
Epoch: (14)
Timestep: 30720
Average actor loss: 2047.5587158203125
Average critic loss: 4079745853.2
Average episode reward: -66182.7334798177
Epoch: (15)
Timestep: 32768
Average actor loss: 2052.34130859375
Average critic loss: 4139815035.125
Average episode reward: -66337.21076202393
Epoch: (16)
Timestep: 34816
Average actor loss: 2052.64404296875
Average critic loss: 4183405551.882353
Average episode reward: -66346.87725471047
Epoch: (17)
Timestep: 36864
Average actor loss: 2058.827880859375
Average critic loss: 4161406245.4444447
Average episode reward: -66546.62322998047
Epoch: (18)
Timestep: 38912
Average actor loss: 2060.817626953125
Average critic loss: 4121971221.263158
Average episode reward: -66610.7903281764
Epoch: (19)
Timestep: 40960
Average actor loss: 2060.830078125
Average critic loss: 4114391547.8
Average episode reward: -66611.03524169922
Epoch: (20)
Timestep: 43008
Average actor loss: 2066.997314453125
Average critic loss: 4251848994.6666665
Average episode reward: -66810.21591913133
Epoch: (21)
Timestep: 45056
Average actor loss: 2066.41552734375
Average critic loss: 4278450642.3636365
Average episode reward: -66791.22914817116
Epoch: (22)
Timestep: 47104
Average actor loss: 2060.1669921875
Average critic loss: 4234161171.9130435
Average episode reward: -66589.0634765625
Epoch: (23)
Timestep: 49152
Average actor loss: 2055.429931640625
Average critic loss: 4202572487.4166665
Average episode reward: -66435.73211161296
Epoch: (24)
Timestep: 51200
Average actor loss: 2053.62939453125
Average critic loss: 4161528215.76
Average episode reward: -66377.30724121093
Epoch: (25)
Timestep: 53248
Average actor loss: 2054.104736328125
Average critic loss: 4154062625.6923075
Average episode reward: -66392.41322678786
Epoch: (26)
Timestep: 55296
Average actor loss: 2051.61181640625
Average critic loss: 4152577481.4814816
Average episode reward: -66311.57270869502
Epoch: (27)
Timestep: 57344
Average actor loss: 2050.49609375
Average critic loss: 4157789479.5
Average episode reward: -66275.22402954102
Epoch: (28)
Timestep: 59392
Average actor loss: 2055.855224609375
Average critic loss: 4180449712.0689654
Average episode reward: -66448.15928492053
Epoch: (29)
Timestep: 61440
Average actor loss: 2056.79150390625
Average critic loss: 4163453853.4
Average episode reward: -66478.0987508138
Epoch: (30)
Timestep: 63488
Average actor loss: 2055.386474609375
Average critic loss: 4200514524.580645
Average episode reward: -66432.35590977823
Epoch: (31)
Timestep: 65536
Average actor loss: 2043.7030029296875
Average critic loss: 4140981730.3125
Average episode reward: -66054.32428741455
Epoch: (32)
Timestep: 67584
Average actor loss: 2020.7803955078125
Average critic loss: 4052714147.6969695
Average episode reward: -65313.000310724434
Epoch: (33)
Timestep: 69632
Average actor loss: 2008.2520751953125
Average critic loss: 3985699905.7647057
Average episode reward: -64907.65843649471
Epoch: (34)
Timestep: 71680
Average actor loss: 2023.29736328125
Average critic loss: 3995600071.0857143
Average episode reward: -65393.50582101005
Epoch: (35)
Timestep: 73728
Average actor loss: 2025.7354736328125
Average critic loss: 4019213037.111111
Average episode reward: -65471.88198852539
Epoch: (36)
Timestep: 75776
Average actor loss: 2022.7236328125
Average critic loss: 3990202666.4324327
Average episode reward: -65374.06211729308
Epoch: (37)
Timestep: 77824
Average actor loss: 2026.7559814453125
Average critic loss: 3971656235.105263
Average episode reward: -65503.88615337171
Epoch: (38)
Timestep: 79872
Average actor loss: 2032.162109375
Average critic loss: 4004785505.8974357
Average episode reward: -65678.12201397236
Epoch: (39)
Timestep: 81920
Average actor loss: 2033.5638427734375
Average critic loss: 4009320727.45
Average episode reward: -65722.88467407227
Epoch: (40)
Timestep: 83968
Average actor loss: 2034.0595703125
Average critic loss: 4033502493.804878
Average episode reward: -65738.33700635956
Epoch: (41)
Timestep: 86016
Average actor loss: 2036.9722900390625
Average critic loss: 4009700381.428571
Average episode reward: -65831.88615490141
Epoch: (42)
Timestep: 88064
Average actor loss: 2038.8839111328125
Average critic loss: 4009446974.418605
Average episode reward: -65893.04638671875
Epoch: (43)
Timestep: 90112
Average actor loss: 2033.986083984375
Average critic loss: 3982055387.5454545
Average episode reward: -65734.08194802025
Epoch: (44)
Timestep: 92160
Average actor loss: 2035.487060546875
Average critic loss: 3991832990.177778
Average episode reward: -65781.92784830728
Epoch: (45)
Timestep: 94208
Average actor loss: 2034.78857421875
Average critic loss: 3979858649.173913
Average episode reward: -65758.62313975459
Epoch: (46)
Timestep: 96256
Average actor loss: 2035.6236572265625
Average critic loss: 3980140585.9148936
Average episode reward: -65784.87284688746
Epoch: (47)
Timestep: 98304
Average actor loss: 2036.9779052734375
Average critic loss: 3969185529.125
Average episode reward: -65827.86477406819
Epoch: (48)
Timestep: 100352
Average actor loss: 2037.6461181640625
Average critic loss: 3993764067.632653
Average episode reward: -65848.65565957829
Epoch: (49)
Timestep: 102400
Average actor loss: 2040.1085205078125
Average critic loss: 4015487046.72
Average episode reward: -65927.41112548829
Epoch: (50)
Timestep: 104448
Average actor loss: 2040.601318359375
Average critic loss: 4031942470.1960783
Average episode reward: -65942.48114612055
Epoch: (51)
Timestep: 106496
Average actor loss: 2038.59228515625
Average critic loss: 4004971795.730769
Average episode reward: -65876.6249225323
Epoch: (52)
Timestep: 108544
Average actor loss: 2040.6719970703125
Average critic loss: 3993428541.6226416
Average episode reward: -65942.89313319944
Epoch: (53)
Timestep: 110592
Average actor loss: 2040.718994140625
Average critic loss: 3967326559.037037
Average episode reward: -65943.44222231265
Epoch: (54)
Timestep: 112640
Average actor loss: 2039.263916015625
Average critic loss: 3948125725.672727
Average episode reward: -65895.38966397372
Epoch: (55)
Timestep: 114688
Average actor loss: 2043.468505859375
Average critic loss: 3971356659.571429
Average episode reward: -66030.2391204834
Epoch: (56)
Timestep: 116736
Average actor loss: 2043.0159912109375
Average critic loss: 3963795076.982456
Average episode reward: -66014.54153388843
Epoch: (57)
Timestep: 118784
Average actor loss: 2043.1619873046875
Average critic loss: 3951278566.793103
Average episode reward: -66018.1185913086
Epoch: (58)
Timestep: 120832
Average actor loss: 2048.749267578125
Average critic loss: 3977440174.237288
Average episode reward: -66197.55196264235
Epoch: (59)
Timestep: 122880
Average actor loss: 2051.68212890625
Average critic loss: 4011427861.5
Average episode reward: -66291.14991861979
Epoch: (60)
Timestep: 124928
Average actor loss: 2050.610107421875
Average critic loss: 3993524932.196721
Average episode reward: -66255.2563536597
Epoch: (61)
Timestep: 126976
Average actor loss: 2050.435302734375
Average critic loss: 3985416231.451613
Average episode reward: -66248.31843025454
Epoch: (62)
Timestep: 129024
Average actor loss: 2047.173828125
Average critic loss: 3964712992.2539682
Average episode reward: -66141.57194785467
Epoch: (63)
Timestep: 131072
Average actor loss: 2035.599365234375
Average critic loss: 3917983727.4375
Average episode reward: -65766.08421516418
Epoch: (64)
Timestep: 133120
Average actor loss: 2027.42333984375
Average critic loss: 3876412154.230769
Average episode reward: -65500.434515850364
Epoch: (65)
Timestep: 135168
Average actor loss: 2033.3873291015625
Average critic loss: 3863748012.681818
Average episode reward: -65691.6924789891
Epoch: (66)
Timestep: 137216
Average actor loss: 2037.2926025390625
Average critic loss: 3875041048.6119404
Average episode reward: -65816.43869701785
Epoch: (67)
Timestep: 139264
Average actor loss: 2034.164794921875
Average critic loss: 3849832623.4852943
Average episode reward: -65713.78910019819
Epoch: (68)
Timestep: 141312
Average actor loss: 2032.087890625
Average critic loss: 3821099470.9565215
Average episode reward: -65645.09462218353
Epoch: (69)
Timestep: 143360
Average actor loss: 2034.73779296875
Average critic loss: 3811279308.3428574
Average episode reward: -65729.13927699497
Epoch: (70)
Timestep: 145408
Average actor loss: 2038.2330322265625
Average critic loss: 3827217089.887324
Average episode reward: -65840.45203668298
Epoch: (71)
Timestep: 147456
Average actor loss: 2037.8914794921875
Average critic loss: 3808819839.7222223
Average episode reward: -65827.68321567112
Epoch: (72)
Timestep: 149504
Average actor loss: 2038.4986572265625
Average critic loss: 3794018102.0
Average episode reward: -65845.5685700717
Epoch: (73)
Timestep: 151552
Average actor loss: 2039.283203125
Average critic loss: 3796781700.5675673
Average episode reward: -65869.12043885927
Epoch: (74)
Timestep: 153600
Average actor loss: 2040.9254150390625
Average critic loss: 3805655753.4666667
Average episode reward: -65920.37224772136
Epoch: (75)
Timestep: 155648
Average actor loss: 2041.4407958984375
Average critic loss: 3792301029.0
Average episode reward: -65935.12641987047
Epoch: (76)
Timestep: 157696
Average actor loss: 2039.3314208984375
Average critic loss: 3771986103.5454545
Average episode reward: -65864.98412610339
Epoch: (77)
Timestep: 159744
Average actor loss: 2039.809326171875
Average critic loss: 3764943344.1666665
Average episode reward: -65878.44496506911
Epoch: (78)
Timestep: 161792
Average actor loss: 2040.367919921875
Average critic loss: 3762594383.481013
Average episode reward: -65894.46595628955
Epoch: (79)
Timestep: 163840
Average actor loss: 2043.1923828125
Average critic loss: 3756983308.7875
Average episode reward: -65983.6534362793
Epoch: (80)
Timestep: 165888
Average actor loss: 2044.691162109375
Average critic loss: 3768995164.6419754
Average episode reward: -66029.98031051071
Epoch: (81)
Timestep: 167936
Average actor loss: 2045.560302734375
Average critic loss: 3773739768.878049
Average episode reward: -66055.87721810689
Epoch: (82)
Timestep: 169984
Average actor loss: 2047.8958740234375
Average critic loss: 3762344818.554217
Average episode reward: -66129.12023925781
Epoch: (83)
Timestep: 172032
Average actor loss: 2048.1845703125
Average critic loss: 3747150285.904762
Average episode reward: -66136.14793032692
Epoch: (84)
Timestep: 174080
Average actor loss: 2049.437744140625
Average critic loss: 3759705954.3764706
Average episode reward: -66174.30600442326
Epoch: (85)
Timestep: 176128
Average actor loss: 2049.211181640625
Average critic loss: 3754814349.0697675
Average episode reward: -66164.58992607649
Epoch: (86)
Timestep: 178176
Average actor loss: 2049.972412109375
Average critic loss: 3755029401.609195
Average episode reward: -66186.74368180899
Epoch: (87)
Timestep: 180224
Average actor loss: 2048.995849609375
Average critic loss: 3738234197.5227275
Average episode reward: -66152.64991344106
Epoch: (88)
Timestep: 182272
Average actor loss: 2048.7255859375
Average critic loss: 3722844729.820225
Average episode reward: -66141.34817882067
Epoch: (89)
Timestep: 184320
Average actor loss: 2049.518310546875
Average critic loss: 3725223737.6666665
Average episode reward: -66164.34528401693
Epoch: (90)
Timestep: 186368
Average actor loss: 2051.28857421875
Average critic loss: 3715601167.857143
Average episode reward: -66218.89618389423
Epoch: (91)
Timestep: 188416
Average actor loss: 2050.99365234375
Average critic loss: 3705125616.5108695
Average episode reward: -66206.63321055537
Epoch: (92)
Timestep: 190464
Average actor loss: 2052.556884765625
Average critic loss: 3698120014.5591397
Average episode reward: -66254.35237236433
Epoch: (93)
Timestep: 192512
Average actor loss: 2053.59326171875
Average critic loss: 3701504678.1702127
Average episode reward: -66285.00608663356
Epoch: (94)
Timestep: 194560
Average actor loss: 2047.0230712890625
Average critic loss: 3670849390.3473682
Average episode reward: -66069.73012309827
Epoch: (95)
Timestep: 196608
Average actor loss: 2040.8857421875
Average critic loss: 3639270255.109375
Average episode reward: -65868.36539204915
Epoch: (96)
Timestep: 198656
Average actor loss: 2040.218505859375
Average critic loss: 3613147869.1804123
Average episode reward: -65843.72947834448
Epoch: (97)
Timestep: 200704
Average actor loss: 2044.071533203125
Average critic loss: 3617708921.413265
Average episode reward: -65965.17269087811
Epoch: (98)
Timestep: 202752
Average actor loss: 2042.96826171875
Average critic loss: 3594019052.318182
Average episode reward: -65926.36008892638
Epoch: (99)
Timestep: 204800
Average actor loss: 2045.3409423828125
Average critic loss: 3587409976.185
Average episode reward: -65999.83588378906
Epoch: (100)
Timestep: 206848
Average actor loss: 2050.276611328125
Average critic loss: 3588500458.105
Average episode reward: -66154.9665625
Epoch: (101)
Timestep: 208896
Average actor loss: 2058.666259765625
Average critic loss: 3610399988.305
Average episode reward: -66421.59349853516
Epoch: (102)
Timestep: 210944
Average actor loss: 2061.8798828125
Average critic loss: 3602711873.105
Average episode reward: -66520.77129516602
Epoch: (103)
Timestep: 212992
Average actor loss: 2056.026611328125
Average critic loss: 3562137063.965
Average episode reward: -66326.76745117188
Epoch: (104)
Timestep: 215040
Average actor loss: 2058.361572265625
Average critic loss: 3597929602.495
Average episode reward: -66397.27978881836
Epoch: (105)
Timestep: 217088
Average actor loss: 2058.86328125
Average critic loss: 3568080944.225
Average episode reward: -66408.40205810546
Epoch: (106)
Timestep: 219136
Average actor loss: 2058.59130859375
Average critic loss: 3569870649.325
Average episode reward: -66394.3825427246
Epoch: (107)
Timestep: 221184
Average actor loss: 2057.540771484375
Average critic loss: 3545516022.745
Average episode reward: -66355.04472167969
Epoch: (108)
Timestep: 223232
Average actor loss: 2056.470458984375
Average critic loss: 3527587298.135
Average episode reward: -66314.92539794922
Epoch: (109)
Timestep: 225280
Average actor loss: 2056.57958984375
Average critic loss: 3522637071.075
Average episode reward: -66312.77631469727
Epoch: (110)
Timestep: 227328
Average actor loss: 2057.760986328125
Average critic loss: 3511334883.715
Average episode reward: -66345.13256103516
Epoch: (111)
Timestep: 229376
Average actor loss: 2059.779296875
Average critic loss: 3528762587.55
Average episode reward: -66404.40230957032
Epoch: (112)
Timestep: 231424
Average actor loss: 2059.643798828125
Average critic loss: 3510160428.13
Average episode reward: -66393.8805029297
Epoch: (113)
Timestep: 233472
Average actor loss: 2061.0126953125
Average critic loss: 3490404553.36
Average episode reward: -66431.84635864258
Epoch: (114)
Timestep: 235520
Average actor loss: 2060.6533203125
Average critic loss: 3470029605.34
Average episode reward: -66413.75396606445
Epoch: (115)
Timestep: 237568
Average actor loss: 2062.572021484375
Average critic loss: 3445443500.98
Average episode reward: -66469.15325195313
Epoch: (116)
Timestep: 239616
Average actor loss: 2063.143310546875
Average critic loss: 3420305854.1
Average episode reward: -66480.81983764649
Epoch: (117)
Timestep: 241664
Average actor loss: 2061.5673828125
Average critic loss: 3400167385.465
Average episode reward: -66422.93498413086
Epoch: (118)
Timestep: 243712
Average actor loss: 2062.667236328125
Average critic loss: 3388477208.635
Average episode reward: -66451.34255004882
Epoch: (119)
Timestep: 245760
Average actor loss: 2064.3681640625
Average critic loss: 3391636102.905
Average episode reward: -66499.02090942382
Epoch: (120)
Timestep: 247808
Average actor loss: 2062.811767578125
Average critic loss: 3342149958.425
Average episode reward: -66441.23377197265
Epoch: (121)
Timestep: 249856
Average actor loss: 2063.084228515625
Average critic loss: 3325188434.03
Average episode reward: -66442.3909802246
Epoch: (122)
Timestep: 251904
Average actor loss: 2063.077392578125
Average critic loss: 3309974997.99
Average episode reward: -66434.33553222656
Epoch: (123)
Timestep: 253952
Average actor loss: 2063.6259765625
Average critic loss: 3289415208.925
Average episode reward: -66444.04885742188
Epoch: (124)
Timestep: 256000
Average actor loss: 2064.616943359375
Average critic loss: 3275915167.735
Average episode reward: -66469.97916748047
Epoch: (125)
Timestep: 258048
Average actor loss: 2059.648193359375
Average critic loss: 3241645879.51
Average episode reward: -66301.00554321289
Epoch: (126)
Timestep: 260096
Average actor loss: 2053.886474609375
Average critic loss: 3203409547.9925
Average episode reward: -66106.18670654297
Epoch: (127)
Timestep: 262144
Average actor loss: 2051.39111328125
Average critic loss: 3168418593.0325
Average episode reward: -66016.74344848633
Epoch: (128)
Timestep: 264192
Average actor loss: 2055.8671875
Average critic loss: 3150123679.5925
Average episode reward: -66152.45865600585
Epoch: (129)
Timestep: 266240
Average actor loss: 2054.612548828125
Average critic loss: 3128188374.4775
Average episode reward: -66102.75108154297
Epoch: (130)
Timestep: 268288
Average actor loss: 2052.604248046875
Average critic loss: 3084927479.4175
Average episode reward: -66028.49276611328
Epoch: (131)
Timestep: 270336
Average actor loss: 2056.266357421875
Average critic loss: 3081199911.2175
Average episode reward: -66137.32318847656
Epoch: (132)
Timestep: 272384
Average actor loss: 2065.204345703125
Average critic loss: 3090884235.5675
Average episode reward: -66416.4822265625
Epoch: (133)
Timestep: 274432
Average actor loss: 2069.001953125
Average critic loss: 3104245189.6925
Average episode reward: -66529.28223144531
Epoch: (134)
Timestep: 276480
Average actor loss: 2067.4453125
Average critic loss: 3082914564.5125
Average episode reward: -66468.81232666016
Epoch: (135)
Timestep: 278528
Average actor loss: 2066.66796875
Average critic loss: 3053078327.3425
Average episode reward: -66433.32305664063
Epoch: (136)
Timestep: 280576
Average actor loss: 2065.72802734375
Average critic loss: 3031426514.005
Average episode reward: -66392.35618652344
Traceback (most recent call last):
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/train.py", line 77, in <module>
    shac.train()
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/algo.py", line 177, in train
    rets, states, episode_reward = self.rollout(states)
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/algo.py", line 279, in rollout
    states, rewards, dones, truncateds, info = self.envs.step(self)
                                               ^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/simulation.py", line 326, in step
    self.x, self.dt * self.runge_integrator(self.x, nu, self.dt, self.t)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/simulation.py", line 171, in runge_integrator
    k4 = self.plant.rhs(t + dt, x + dt * k3, u)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/plant.py", line 83, in rhs
    accn = self.forward_dynamics(x, u)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/plant.py", line 65, in forward_dynamics
    F = self.coulomb_tensor(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/work/flemingc/nvan21/projects/iros_simulator/src/python/double_pendulum/controller/SHAC/plant.py", line 168, in coulomb_tensor
    torch.arctan(100 * vel),
    ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt